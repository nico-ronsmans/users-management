<section class="user-detail">
  @if (person() === undefined) {
    <div class="loading-state text-center py-4">
      <div class="spinner"></div>
      <p>Loading user information...</p>
    </div>
  } @else if (person() === null) {
    <section class="card p-3 shadow-sm text-center">
      <h3 class="section-title">User not found</h3>
      <p class="empty-text mb-3">The requested user does not exist or was removed.</p>
      <button [routerLink]="'/'" class="btn btn-sm btn-outline-primary">Go back</button>
    </section>
  } @else if (person()) {
    <header class="header d-flex align-items-center gap-3 mb-3">
      <button [routerLink]="'/'" class="btn btn-sm btn-outline-primary back-btn">Back</button>
      <h2 class="user-detail-name mb-0">{{ person()?.name }}</h2>
    </header>

    <section class="user-detail-pii card mb-3 p-3 shadow-sm">
      <h3 class="section-title">Personal Information</h3>
      @if (piiEntries().length > 0) {
        <div class="pii-groups">
          @for (group of piiEntries(); track $index) {
            <article class="pii-group mb-2">
              <h4 class="pii-group-title">{{ group[0] }}</h4>
              <ul class="pii-group-list">
                @for (value of group[1]; track $index) {
                  <li>{{ value }}</li>
                }
              </ul>
            </article>
          }
        </div>
      } @else {
        <p class="empty-text">No personal data available.</p>
      }
    </section>

    <section class="card p-3 shadow-sm">
      <h3 class="section-title">Data Sources</h3>
      @if (dataSourceGroups().length > 0) {
        <div class="ds-groups">
          @for (ds of dataSourceGroups(); track $index) {
            <article class="ds-group mb-2">
              <h4 class="ds-group-title">{{ ds[0] }}</h4>
              <ul class="ds-group-list">
                @for (item of ds[1]; track $index) {
                  <li class="ds-group__item">{{ item }}</li>
                }
              </ul>
            </article>
          }
        </div>
      } @else {
        <p class="empty-text">No data sources available.</p>
      }
    </section>
  }
</section>
